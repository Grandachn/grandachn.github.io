<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker基本操作 | granda&#39;s blog</title>
    <meta name="description" content="笔记">
    
    
    <link rel="preload" href="/assets/css/0.styles.01e0b4b8.css" as="style"><link rel="preload" href="/assets/js/app.1abb1d62.js" as="script"><link rel="preload" href="/assets/js/5.9f359203.js" as="script"><link rel="prefetch" href="/assets/js/10.655613a3.js"><link rel="prefetch" href="/assets/js/11.b2572ea0.js"><link rel="prefetch" href="/assets/js/12.e87997d1.js"><link rel="prefetch" href="/assets/js/13.ba9de7a5.js"><link rel="prefetch" href="/assets/js/14.42369655.js"><link rel="prefetch" href="/assets/js/15.3d194d65.js"><link rel="prefetch" href="/assets/js/2.8ac41a9e.js"><link rel="prefetch" href="/assets/js/3.a3d400ce.js"><link rel="prefetch" href="/assets/js/4.a976edf2.js"><link rel="prefetch" href="/assets/js/6.b6556ead.js"><link rel="prefetch" href="/assets/js/7.f831e313.js"><link rel="prefetch" href="/assets/js/8.f00c23ab.js"><link rel="prefetch" href="/assets/js/9.650e0059.js">
    <link rel="stylesheet" href="/assets/css/0.styles.01e0b4b8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">granda's blog</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/" class="nav-link">Java</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dubbo/" class="nav-link">dubbo</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link router-link-active">docker</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">算法题</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/leetCode/" class="nav-link">leetCode</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="https://www.github.com/grandachn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/java/" class="nav-link">Java</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">开源框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dubbo/" class="nav-link">dubbo</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link router-link-active">docker</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">算法题</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/leetCode/" class="nav-link">leetCode</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="https://www.github.com/grandachn" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>使用手册</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/docker/Docker基本操作.html" class="active sidebar-link">Docker基本操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docker/Docker基本操作.html#docker的安装和使用" class="sidebar-link">docker的安装和使用</a></li><li class="sidebar-sub-header"><a href="/docker/Docker基本操作.html#docker服务的启动、停止和重启" class="sidebar-link">docker服务的启动、停止和重启</a></li><li class="sidebar-sub-header"><a href="/docker/Docker基本操作.html#镜像的拉取（pull）" class="sidebar-link">镜像的拉取（pull）</a></li><li class="sidebar-sub-header"><a href="/docker/Docker基本操作.html#容器的操作" class="sidebar-link">容器的操作</a></li><li class="sidebar-sub-header"><a href="/docker/Docker基本操作.html#镜像的创建" class="sidebar-link">镜像的创建</a></li><li class="sidebar-sub-header"><a href="/docker/Docker基本操作.html#镜像的存出和载入" class="sidebar-link">镜像的存出和载入</a></li><li class="sidebar-sub-header"><a href="/docker/Docker基本操作.html#镜像的上传" class="sidebar-link">镜像的上传</a></li><li class="sidebar-sub-header"><a href="/docker/Docker基本操作.html#容器和主机间的文件复制" class="sidebar-link">容器和主机间的文件复制</a></li><li class="sidebar-sub-header"><a href="/docker/Docker基本操作.html#linux和远程主机的文件复制" class="sidebar-link">Linux和远程主机的文件复制</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="docker基本操作"><a href="#docker基本操作" aria-hidden="true" class="header-anchor">#</a> Docker基本操作</h1> <h2 id="docker的安装和使用"><a href="#docker的安装和使用" aria-hidden="true" class="header-anchor">#</a> docker的安装和使用</h2> <ul><li>我用的是Ubuntu16，可以执行下面命令快捷安装</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> docker.io
</code></pre></div><ul><li>如果是其他linux发行版，如CentOS可以用Yum命令，也可以执行下面的从网络获取的脚本来进行安装</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">curl</span> -s http://get.docker.com<span class="token operator">|</span>sh
</code></pre></div><h2 id="docker服务的启动、停止和重启"><a href="#docker服务的启动、停止和重启" aria-hidden="true" class="header-anchor">#</a> docker服务的启动、停止和重启</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">service</span> docker start
<span class="token function">sudo</span> <span class="token function">service</span> docker stop
<span class="token function">sudo</span> <span class="token function">service</span> docker restart
</code></pre></div><ul><li>输入</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> docker version 
</code></pre></div><ul><li>看到下图就是启动成功了
<img src="http://upload-images.jianshu.io/upload_images/3372306-9c37ed68d68fd2c7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Paste_Image.png"></li></ul> <h2 id="镜像的拉取（pull）"><a href="#镜像的拉取（pull）" aria-hidden="true" class="header-anchor">#</a> 镜像的拉取（pull）</h2> <ul><li>docker官方的镜像仓库：hub.docker.com</li> <li>网易的仓库：c.163.com</li> <li>docker的命令基本都是要root权限的，所以我们直接su进入root进行操作</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>//从远程仓库拉取镜像到本地仓库
docker pull <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> NAME<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span>
//显示本地仓库的镜像
docker images <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> <span class="token punctuation">[</span>RESPOSITORY<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span><span class="token punctuation">]</span>
//从指定的一个本地镜像创建一个容器
docker run <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span> IMAGE<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span><span class="token punctuation">[</span>COMMAND<span class="token punctuation">]</span><span class="token punctuation">[</span>ARG<span class="token punctuation">..</span>.<span class="token punctuation">]</span>    -d 后台运行	-p 8080:80 主机端口：容器端口 
//删除一个镜像
docker rmi imageId
</code></pre></div><h2 id="容器的操作"><a href="#容器的操作" aria-hidden="true" class="header-anchor">#</a> 容器的操作</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>//打印正在运行的容器，加上-a打印所有容器
docker <span class="token function">ps</span>
//停止一个容器
docker stop containerId
//重启一个容器
docker restart containerId
//进入一个容器
docker <span class="token function">exec</span> -it containerId <span class="token function">bash</span>
//删除一个容器
docker <span class="token function">rm</span> containerId
//删除已经退出运行的所有容器
docker <span class="token function">ps</span> -a <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;Exited&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span> }'</span><span class="token operator">|</span><span class="token function">xargs</span> docker <span class="token function">rm</span>
</code></pre></div><h2 id="镜像的创建"><a href="#镜像的创建" aria-hidden="true" class="header-anchor">#</a> 镜像的创建</h2> <ul><li>vim Dockerfile</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>from ubuntu16/tomcat/jpress

MAINTAINER granda grandachn@163.com

ENV JAVA_HOME  /usr/lib/jvm/jdk1.8.0_121
ENV PATH      <span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$PATH</span>
ENV CLASSPATH   .:<span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar

ENTRYPOINT /usr/local/tomcat/bin/startup.sh <span class="token operator">&amp;&amp;</span> <span class="token function">tail</span> -F /root/apache-tomcat-7.0.70/logs/catalina.out
</code></pre></div><ul><li>注意：执行完脚本命令后容器是会自动停止的，所以要用tail命令持续输出日志内容，使得容器保持运行</li> <li>在Dockerfile目录下执行下面命令构建镜像</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>docker build -t jpress:latest <span class="token keyword">.</span>
</code></pre></div><ul><li>也可以根据创建的这个容器来提交一个新的镜像，提交时需要用到容器ID</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>docker commit –m “testMessage” –a “granda” d8990fec2141 testimage
</code></pre></div><ul><li>或者，也可以从操作系统模板文件导入一个镜像</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">wget</span> http://download.openvz.org/template/precreated/ubuntu-14.04-x86_64-minimal.tar.gz
<span class="token function">sudo</span> <span class="token function">cat</span> ubuntu–14.04–x86_64–minimal.tar.gz <span class="token operator">|</span> docker <span class="token function">import</span> – ubuntu:14.04
</code></pre></div><h2 id="镜像的存出和载入"><a href="#镜像的存出和载入" aria-hidden="true" class="header-anchor">#</a> 镜像的存出和载入</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>docker save –o /data/testimage.tar testimage:latest
docker load —input testimage.tar
//或者
docker load <span class="token operator">&lt;</span> testimage.tar
</code></pre></div><h2 id="镜像的上传"><a href="#镜像的上传" aria-hidden="true" class="header-anchor">#</a> 镜像的上传</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>docker push NAME<span class="token punctuation">[</span>:TAG<span class="token punctuation">]</span> 
docker tag testimage:lastest granda/testimage:lastest
docker push granda/testimage:lastest
</code></pre></div><h2 id="容器和主机间的文件复制"><a href="#容器和主机间的文件复制" aria-hidden="true" class="header-anchor">#</a> 容器和主机间的文件复制</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>docker <span class="token function">cp</span> foo.txt mycontainer:/foo.txt
docker <span class="token function">cp</span> mycontainer:/foo.txt foo.txt
</code></pre></div><h2 id="linux和远程主机的文件复制"><a href="#linux和远程主机的文件复制" aria-hidden="true" class="header-anchor">#</a> Linux和远程主机的文件复制</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">scp</span> /home/granda/Desktop/test.txt root@192.168.1.100:/root/
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/5.9f359203.js" defer></script><script src="/assets/js/app.1abb1d62.js" defer></script>
  </body>
</html>
